!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mapboxGlDrawSnapMode=e():t.mapboxGlDrawSnapMode=e()}(this,(()=>(()=>{var t={778:(t,e,r)=>{var n=r(628);function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(i(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(i(t[r]))}return e}function i(t){var e,r,o,i,s,u,c=0,l=t.length;if(l>2){for(u=0;u<l;u++)u===l-2?(o=l-2,i=l-1,s=0):u===l-1?(o=l-1,i=0,s=1):(o=u,i=u+1,s=u+2),e=t[o],r=t[i],c+=(a(t[s][0])-a(e[0]))*Math.sin(a(r[1]));c=c*n.RADIUS*n.RADIUS/2}return c}function a(t){return t*Math.PI/180}t.exports.geometry=function t(e){var r,n=0;switch(e.type){case"Polygon":return o(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)n+=o(e.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)n+=t(e.geometries[r]);return n}},t.exports.ring=i},186:t=>{t.exports=function(t){if(!t||!t.type)return null;var r=e[t.type];if(!r)return null;if("geometry"===r)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===r)return{type:"FeatureCollection",features:[t]};if("featurecollection"===r)return t};var e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},383:(t,e,r)=>{"use strict";var n=r(421);function o(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}o.default=o,e.A=o},967:(t,e)=>{"use strict";function r(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!h(t[0])||!h(t[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:t},e,n)}function o(t,e,n){void 0===n&&(n={});for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:t},e,n)}function i(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:t},e,n)}function a(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function s(t,e,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:t},e,n)}function l(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function p(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function d(t){return 180*(t%(2*Math.PI))/Math.PI}function h(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=r,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return n(e).geometry;case"LineString":return i(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return s(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,r){return void 0===r&&(r={}),a(t.map((function(t){return n(t,e)})),r)},e.polygon=o,e.polygons=function(t,e,r){return void 0===r&&(r={}),a(t.map((function(t){return o(t,e)})),r)},e.lineString=i,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),a(t.map((function(t){return i(t,e)})),r)},e.featureCollection=a,e.multiLineString=s,e.multiPoint=u,e.multiPolygon=c,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=l,e.lengthToRadians=p,e.lengthToDegrees=function(t,e){return d(p(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=d,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return l(p(t,e),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[r];if(!o)throw new Error("invalid original units");var i=e.areaFactors[n];if(!i)throw new Error("invalid final units");return t/o*i},e.isNumber=h,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!h(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},421:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(967);function o(t,e,r){if(null!==t)for(var n,i,a,s,u,c,l,p,d=0,h=0,f=t.type,g="FeatureCollection"===f,y="Feature"===f,m=g?t.features.length:1,v=0;v<m;v++){u=(p=!!(l=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var b=0;b<u;b++){var E=0,S=0;if(null!==(s=p?l.geometries[b]:l)){c=s.coordinates;var O=s.type;switch(d=!r||"Polygon"!==O&&"MultiPolygon"!==O?0:1,O){case null:break;case"Point":if(!1===e(c,h,v,E,S))return!1;h++,E++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(!1===e(c[n],h,v,E,S))return!1;h++,"MultiPoint"===O&&E++}"LineString"===O&&E++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-d;i++){if(!1===e(c[n][i],h,v,E,S))return!1;h++}"MultiLineString"===O&&E++,"Polygon"===O&&S++}"Polygon"===O&&E++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(S=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-d;a++){if(!1===e(c[n][i][a],h,v,E,S))return!1;h++}S++}E++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===o(s.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function s(t,e){var r,n,o,i,a,s,u,c,l,p,d=0,h="FeatureCollection"===t.type,f="Feature"===t.type,g=h?t.features.length:1;for(r=0;r<g;r++){for(s=h?t.features[r].geometry:f?t.geometry:t,c=h?t.features[r].properties:f?t.properties:{},l=h?t.features[r].bbox:f?t.bbox:void 0,p=h?t.features[r].id:f?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,d,c,l,p))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],d,c,l,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,l,p))return!1;d++}}function u(t,e){s(t,(function(t,r,o,i,a){var s,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,o,{bbox:i,id:a}),r,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var c=0;c<t.coordinates.length;c++){var l={type:s,coordinates:t.coordinates[c]};if(!1===e(n.feature(l,o),r,c))return!1}}))}function c(t,e){u(t,(function(t,r,i){var a=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,c=0,l=0,p=0;return!1!==o(t,(function(o,s,d,h,f){if(void 0===u||r>c||h>l||f>p)return u=o,c=r,l=h,p=f,void(a=0);var g=n.lineString([u,o],t.properties);if(!1===e(g,r,i,f,a))return!1;a++,u=o}))&&void 0}}}))}function l(t,e){if(!t)throw new Error("geojson is required");u(t,(function(t,r,o){if(null!==t.geometry){var i=t.geometry.type,a=t.geometry.coordinates;switch(i){case"LineString":if(!1===e(t,r,o,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(n.lineString(a[s],t.properties),r,o,s))return!1}}}))}e.coordAll=function(t){var e=[];return o(t,(function(t){e.push(t)})),e},e.coordEach=o,e.coordReduce=function(t,e,r,n){var i=r;return o(t,(function(t,n,o,a,s){i=0===n&&void 0===r?t:e(i,t,n,o,a,s)}),n),i},e.featureEach=a,e.featureReduce=function(t,e,r){var n=r;return a(t,(function(t,o){n=0===o&&void 0===r?t:e(n,t,o)})),n},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),u=u||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":return n.point(c,u,e);case"MultiPoint":return i<0&&(i=c.length+i),n.point(c[i],u,e);case"LineString":return s<0&&(s=c.length+s),n.point(c[s],u,e);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s),n.point(c[a][s],u,e);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s),n.point(c[i][s],u,e);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s),n.point(c[i][a][s],u,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,o=e.featureIndex||0,i=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),u=u||t.features[o].properties,r=t.features[o].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=c.length+s-1),n.lineString([c[s],c[s+1]],u,e);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s-1),n.lineString([c[a][s],c[a][s+1]],u,e);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s-1),n.lineString([c[i][s],c[i][s+1]],u,e);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s-1),n.lineString([c[i][a][s],c[i][a][s+1]],u,e)}throw new Error("geojson is invalid")},e.flattenEach=u,e.flattenReduce=function(t,e,r){var n=r;return u(t,(function(t,o,i){n=0===o&&0===i&&void 0===r?t:e(n,t,o,i)})),n},e.geomEach=s,e.geomReduce=function(t,e,r){var n=r;return s(t,(function(t,o,i,a,s){n=0===o&&void 0===r?t:e(n,t,o,i,a,s)})),n},e.lineEach=l,e.lineReduce=function(t,e,r){var n=r;return l(t,(function(t,o,i,a){n=0===o&&void 0===r?t:e(n,t,o,i,a)})),n},e.propEach=i,e.propReduce=function(t,e,r){var n=r;return i(t,(function(t,o){n=0===o&&void 0===r?t:e(n,t,o)})),n},e.segmentEach=c,e.segmentReduce=function(t,e,r){var n=r,o=!1;return c(t,(function(t,i,a,s,u){n=!1===o&&void 0===r?t:e(n,t,i,a,s,u),o=!0})),n}},17:t=>{"use strict";t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(o=n;0!=o--;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(i=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var a=i[o];if(!t(e[a],r[a]))return!1}return!0}return e!=e&&r!=r}},945:(t,e,r)=>{var n=r(341),o=r(967),i=r(421),a=r(383).A,s=i.featureEach,u=(i.coordEach,o.polygon,o.featureCollection);function c(t){var e=new n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})):s(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return u(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return u(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=a(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=a(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=c,t.exports.default=c},341:function(t){t.exports=function(){"use strict";function t(t,n,o,i,a){!function t(r,n,o,i,a){for(;i>o;){if(i-o>600){var s=i-o+1,u=n-o+1,c=Math.log(s),l=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(r,n,Math.max(o,Math.floor(n-u*l/s+p)),Math.min(i,Math.floor(n+(s-u)*l/s+p)),a)}var d=r[n],h=o,f=i;for(e(r,o,n),a(r[i],d)>0&&e(r,o,i);h<f;){for(e(r,h,f),h++,f--;a(r[h],d)<0;)h++;for(;a(r[f],d)>0;)f--}0===a(r[o],d)?e(r,o,f):e(r,++f,i),f<=n&&(o=f+1),n<=f&&(i=f-1)}}(t,n,o||0,i||t.length-1,a||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function i(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,n,o){o||(o=f(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i=e;i<r;i++){var a=t.children[i];s(o,t.leaf?n(a):a)}return o}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,o,i){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=o)){var s=r+Math.ceil((n-r)/o/2)*o;t(e,s,r,n,i),a.push(r,s,s,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!h(t,e))return r;for(var n=this.toBBox,o=[];e;){for(var i=0;i<e.children.length;i++){var a=e.children[i],s=e.leaf?n(a):a;h(t,s)&&(e.leaf?r.push(a):d(t,s)?this._all(a,r):o.push(a))}e=o.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!h(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],i=e.leaf?this.toBBox(o):o;if(h(t,i)){if(e.leaf||d(t,i))return!0;r.push(o)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,i,a=this.data,s=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],r=c.pop(),i=!0),a.leaf){var l=o(t,a.children,e);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}i||a.leaf||!d(a,s)?n?(r++,a=n.children[r],i=!1):a=null:(u.push(a),c.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var o,a=r-e+1,s=this._maxEntries;if(a<=s)return i(o=f(t.slice(e,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=f([])).leaf=!1,o.height=n;var u=Math.ceil(a/s),c=u*Math.ceil(Math.sqrt(s));g(t,e,r,c,this.compareMinX);for(var l=e;l<=r;l+=c){var p=Math.min(l+c-1,r);g(t,l,p,u,this.compareMinY);for(var d=l;d<=p;d+=u){var h=Math.min(d+u-1,p);o.children.push(this._build(t,d,h,n-1))}}return i(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var o=1/0,i=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=l(u),p=(d=t,h=u,(Math.max(h.maxX,d.maxX)-Math.min(h.minX,d.minX))*(Math.max(h.maxY,d.maxY)-Math.min(h.minY,d.minY))-c);p<i?(i=p,o=c<o?c:o,a=u):p===i&&c<o&&(o=c,a=u)}e=a||e.children[0]}var d,h;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),o=[],i=this._chooseSubtree(n,this.data,e,o);for(i.children.push(t),s(i,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var a=this._chooseSplitIndex(r,o,n),s=f(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,i(r,this.toBBox),i(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,o,i,s,u,c,p,d=1/0,h=1/0,f=e;f<=r-e;f++){var g=a(t,0,f,this.toBBox),y=a(t,f,r,this.toBBox),m=(o=g,i=y,s=void 0,u=void 0,c=void 0,p=void 0,s=Math.max(o.minX,i.minX),u=Math.max(o.minY,i.minY),c=Math.min(o.maxX,i.maxX),p=Math.min(o.maxY,i.maxY),Math.max(0,c-s)*Math.max(0,p-u)),v=l(g)+l(y);m<d?(d=m,n=f,h=v<h?v:h):m===d&&v<h&&(h=v,n=f)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,o=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var o=this.toBBox,i=a(t,0,e,o),u=a(t,r-e,r,o),c=p(i)+p(u),l=e;l<r-e;l++){var d=t.children[l];s(i,t.leaf?o(d):d),c+=p(i)}for(var h=r-e-1;h>=e;h--){var f=t.children[h];s(u,t.leaf?o(f):f),c+=p(u)}return c},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)s(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},n}()},628:t=>{t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.r(n),r.d(n,{SnapDirectSelect:()=>sn,SnapLineMode:()=>kr,SnapModeDrawStyles:()=>gn,SnapPointMode:()=>Ir,SnapPolygonMode:()=>zr,Utils:()=>i});var t={};r.r(t),r.d(t,{LAT_MAX:()=>S,LAT_MIN:()=>b,LAT_RENDERED_MAX:()=>O,LAT_RENDERED_MIN:()=>E,LNG_MAX:()=>I,LNG_MIN:()=>C,activeStates:()=>m,classes:()=>u,cursors:()=>l,events:()=>f,geojsonTypes:()=>d,interactions:()=>v,meta:()=>y,modes:()=>h,sources:()=>c,types:()=>p,updateActions:()=>g});var e={};r.r(e),r.d(e,{isActiveFeature:()=>Et,isEnterKey:()=>Mt,isEscapeKey:()=>xt,isFeature:()=>Ct,isInactiveFeature:()=>St,isOfMetaType:()=>vt,isShiftDown:()=>_t,isShiftMousedown:()=>bt,isTrue:()=>Tt,isVertex:()=>It,noTarget:()=>Ot});var o={};r.r(o),r.d(o,{CommonSelectors:()=>e,ModeHandler:()=>a,StringSet:()=>w,constrainFeatureMovement:()=>Vt,createMidPoint:()=>At,createSupplementaryPoints:()=>Nt,createVertex:()=>Lt,doubleClickZoom:()=>Ft,euclideanDistance:()=>R,featuresAt:()=>A,getFeatureAtAndSetCursors:()=>F,isClick:()=>j,isEventAtCoordinates:()=>Wt,isTap:()=>B,mapEventToBoundingBox:()=>T,moveFeatures:()=>Bt,sortFeatures:()=>M,stringSetsAreEqual:()=>ue,theme:()=>mt,toDenseArray:()=>ut});var i={};r.r(i),r.d(i,{IDS:()=>or,addPointTovertices:()=>ir,createSnapList:()=>ar,getGuideFeature:()=>pr,shouldHideGuide:()=>dr,snap:()=>lr});const a=function(t,e){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on(t,e,n){if(void 0===r[t])throw new Error(`Invalid event type: ${t}`);r[t].push({selector:e,fn:n})},render(t){e.store.featureChanged(t)}},o=function(t,o){const i=r[t];let a=i.length;for(;a--;){const t=i[a];if(t.selector(o)){t.fn.call(n,o)||e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(n),{render:t.render,stop(){t.stop&&t.stop()},trash(){t.trash&&(t.trash(),e.store.render())},combineFeatures(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures(){t.uncombineFeatures&&t.uncombineFeatures()},drag(t){o("drag",t)},click(t){o("click",t)},mousemove(t){o("mousemove",t)},mousedown(t){o("mousedown",t)},mouseup(t){o("mouseup",t)},mouseout(t){o("mouseout",t)},keydown(t){o("keydown",t)},keyup(t){o("keyup",t)},touchstart(t){o("touchstart",t)},touchmove(t){o("touchmove",t)},touchend(t){o("touchend",t)},tap(t){o("tap",t)}}};var s=r(778);const u={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},c={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},l={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},p={POLYGON:"polygon",LINE:"line_string",POINT:"point"},d={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},h={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},f={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},g={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},y={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},m={ACTIVE:"true",INACTIVE:"false"},v=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],b=-90,E=-85,S=90,O=85,C=-270,I=270,_={Point:0,LineString:1,MultiLineString:1,Polygon:2};function x(t,e){const r=_[t.geometry.type]-_[e.geometry.type];return 0===r&&t.geometry.type===d.POLYGON?t.area-e.area:r}const M=function(t){return t.map((t=>(t.geometry.type===d.POLYGON&&(t.area=s.geometry({type:d.FEATURE,property:{},geometry:t.geometry})),t))).sort(x).map((t=>(delete t.area,t)))};const T=function(t,e=0){return[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]};function P(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(let e=0,r=t.length;e<r;e++)this.add(t[e]),void 0!==t[e]&&("string"==typeof t[e]?this._items[t[e]]=e:this._nums[t[e]]=e)}P.prototype.add=function(t){return this.has(t)||(this._length++,"string"==typeof t?this._items[t]=this._length:this._nums[t]=this._length),this},P.prototype.delete=function(t){return!1===this.has(t)||(this._length--,delete this._items[t],delete this._nums[t]),this},P.prototype.has=function(t){return("string"==typeof t||"number"==typeof t)&&(void 0!==this._items[t]||void 0!==this._nums[t])},P.prototype.values=function(){const t=[];return Object.keys(this._items).forEach((e=>{t.push({k:e,v:this._items[e]})})),Object.keys(this._nums).forEach((e=>{t.push({k:JSON.parse(e),v:this._nums[e]})})),t.sort(((t,e)=>t.v-e.v)).map((t=>t.k))},P.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const w=P,L=[y.FEATURE,y.MIDPOINT,y.VERTEX],A={click:function(t,e,r){return N(t,e,r,r.options.clickBuffer)},touch:function(t,e,r){return N(t,e,r,r.options.touchBuffer)}};function N(t,e,r,n){if(null===r.map)return[];const o=t?T(t,n):e,i={};r.options.styles&&(i.layers=r.options.styles.map((t=>t.id)).filter((t=>null!=r.map.getLayer(t))));const a=r.map.queryRenderedFeatures(o,i).filter((t=>-1!==L.indexOf(t.properties.meta))),s=new w,u=[];return a.forEach((t=>{const e=t.properties.id;s.has(e)||(s.add(e),u.push(t))})),M(u)}function F(t,e){const r=A.click(t,null,e),n={mouse:l.NONE};return r[0]&&(n.mouse=r[0].properties.active===m.ACTIVE?l.MOVE:l.POINTER,n.feature=r[0].properties.meta),-1!==e.events.currentModeName().indexOf("draw")&&(n.mouse=l.ADD),e.ui.queueMapClasses(n),e.ui.updateMapClasses(),r[0]}function R(t,e){const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}const D=4,k=12,U=500;function j(t,e,r={}){const n=null!=r.fineTolerance?r.fineTolerance:D,o=null!=r.grossTolerance?r.grossTolerance:k,i=null!=r.interval?r.interval:U;t.point=t.point||e.point,t.time=t.time||e.time;const a=R(t.point,e.point);return a<n||a<o&&e.time-t.time<i}const G=25,V=250;function B(t,e,r={}){const n=null!=r.tolerance?r.tolerance:G,o=null!=r.interval?r.interval:V;t.point=t.point||e.point,t.time=t.time||e.time;return R(t.point,e.point)<n&&e.time-t.time<o}const Y=((t,e=21)=>(r=e)=>{let n="",o=0|r;for(;o--;)n+=t[Math.random()*t.length|0];return n})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function X(){return Y()}const J=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||X(),this.type=e.geometry.type};J.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},J.prototype.incomingCoords=function(t){this.setCoordinates(t)},J.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},J.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},J.prototype.setProperty=function(t,e){this.properties[t]=e},J.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:d.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},J.prototype.internal=function(t){const e={id:this.id,meta:y.FEATURE,"meta:type":this.type,active:m.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(const t in this.properties)e[`user_${t}`]=this.properties[t];return{type:d.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const $=J,H=function(t,e){$.call(this,t,e)};(H.prototype=Object.create($.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},H.prototype.updateCoordinate=function(t,e,r){this.coordinates=3===arguments.length?[e,r]:[t,e],this.changed()},H.prototype.getCoordinate=function(){return this.getCoordinates()};const q=H,Z=function(t,e){$.call(this,t,e)};(Z.prototype=Object.create($.prototype)).isValid=function(){return this.coordinates.length>1},Z.prototype.addCoordinate=function(t,e,r){this.changed();const n=parseInt(t,10);this.coordinates.splice(n,0,[e,r])},Z.prototype.getCoordinate=function(t){const e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},Z.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},Z.prototype.updateCoordinate=function(t,e,r){const n=parseInt(t,10);this.coordinates[n]=[e,r],this.changed()};const z=Z,W=function(t,e){$.call(this,t,e),this.coordinates=this.coordinates.map((t=>t.slice(0,-1)))};(W.prototype=Object.create($.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every((t=>t.length>2))},W.prototype.incomingCoords=function(t){this.coordinates=t.map((t=>t.slice(0,-1))),this.changed()},W.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},W.prototype.addCoordinate=function(t,e,r){this.changed();const n=t.split(".").map((t=>parseInt(t,10)));this.coordinates[n[0]].splice(n[1],0,[e,r])},W.prototype.removeCoordinate=function(t){this.changed();const e=t.split(".").map((t=>parseInt(t,10))),r=this.coordinates[e[0]];r&&(r.splice(e[1],1),r.length<3&&this.coordinates.splice(e[0],1))},W.prototype.getCoordinate=function(t){const e=t.split(".").map((t=>parseInt(t,10))),r=this.coordinates[e[0]];return JSON.parse(JSON.stringify(r[e[1]]))},W.prototype.getCoordinates=function(){return this.coordinates.map((t=>t.concat([t[0]])))},W.prototype.updateCoordinate=function(t,e,r){this.changed();const n=t.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);void 0===this.coordinates[o]&&(this.coordinates[o]=[]),this.coordinates[o][i]=[e,r]};const K=W,Q={MultiPoint:q,MultiLineString:z,MultiPolygon:K},tt=(t,e,r,n,o)=>{const i=r.split("."),a=parseInt(i[0],10),s=i[1]?i.slice(1).join("."):null;return t[a][e](s,n,o)},et=function(t,e){if($.call(this,t,e),delete this.coordinates,this.model=Q[e.geometry.type],void 0===this.model)throw new TypeError(`${e.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(e.geometry.coordinates)};(et.prototype=Object.create($.prototype))._coordinatesToFeatures=function(t){const e=this.model.bind(this);return t.map((t=>new e(this.ctx,{id:X(),type:d.FEATURE,properties:{},geometry:{coordinates:t,type:this.type.replace("Multi","")}})))},et.prototype.isValid=function(){return this.features.every((t=>t.isValid()))},et.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},et.prototype.getCoordinate=function(t){return tt(this.features,"getCoordinate",t)},et.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((t=>t.type===d.POLYGON?t.getCoordinates():t.coordinates))))},et.prototype.updateCoordinate=function(t,e,r){tt(this.features,"updateCoordinate",t,e,r),this.changed()},et.prototype.addCoordinate=function(t,e,r){tt(this.features,"addCoordinate",t,e,r),this.changed()},et.prototype.removeCoordinate=function(t){tt(this.features,"removeCoordinate",t),this.changed()},et.prototype.getFeatures=function(){return this.features};const rt=et;function nt(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t}nt.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},nt.prototype.setSelectedCoordinates=function(t){this._ctx.store.setSelectedCoordinates(t),t.reduce(((t,e)=>(void 0===t[e.feature_id]&&(t[e.feature_id]=!0,this._ctx.store.get(e.feature_id).changed()),t)),{})},nt.prototype.getSelected=function(){return this._ctx.store.getSelected()},nt.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},nt.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},nt.prototype.getFeature=function(t){return this._ctx.store.get(t)},nt.prototype.select=function(t){return this._ctx.store.select(t)},nt.prototype.deselect=function(t){return this._ctx.store.deselect(t)},nt.prototype.deleteFeature=function(t,e={}){return this._ctx.store.delete(t,e)},nt.prototype.addFeature=function(t,e={}){return this._ctx.store.add(t,e)},nt.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},nt.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},nt.prototype.setActionableState=function(t={}){const e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)},nt.prototype.changeMode=function(t,e={},r={}){return this._ctx.events.changeMode(t,e,r)},nt.prototype.fire=function(t,e){return this._ctx.events.fire(t,e)},nt.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},nt.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},nt.prototype.featuresAt=function(t,e,r="click"){if("click"!==r&&"touch"!==r)throw new Error("invalid buffer type");return A[r](t,e,this._ctx)},nt.prototype.newFeature=function(t){const e=t.geometry.type;return e===d.POINT?new q(this._ctx,t):e===d.LINE_STRING?new z(this._ctx,t):e===d.POLYGON?new K(this._ctx,t):new rt(this._ctx,t)},nt.prototype.isInstanceOf=function(t,e){if(t===d.POINT)return e instanceof q;if(t===d.LINE_STRING)return e instanceof z;if(t===d.POLYGON)return e instanceof K;if("MultiFeature"===t)return e instanceof rt;throw new Error(`Unknown feature class: ${t}`)},nt.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)};const ot=nt;nt.prototype.onSetup=function(){},nt.prototype.onDrag=function(){},nt.prototype.onClick=function(){},nt.prototype.onMouseMove=function(){},nt.prototype.onMouseDown=function(){},nt.prototype.onMouseUp=function(){},nt.prototype.onMouseOut=function(){},nt.prototype.onKeyUp=function(){},nt.prototype.onKeyDown=function(){},nt.prototype.onTouchStart=function(){},nt.prototype.onTouchMove=function(){},nt.prototype.onTouchEnd=function(){},nt.prototype.onTap=function(){},nt.prototype.onStop=function(){},nt.prototype.onTrash=function(){},nt.prototype.onCombineFeature=function(){},nt.prototype.onUncombineFeature=function(){},nt.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const it={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},at=Object.keys(it);function st(t){const e=Object.keys(t);return function(r,n={}){let o={};const i=e.reduce(((e,r)=>(e[r]=t[r],e)),new ot(r));return{start(){o=i.onSetup(n),at.forEach((e=>{const r=it[e];let n=()=>!1;var a;t[r]&&(n=()=>!0),this.on(e,n,(a=r,t=>i[a](o,t)))}))},stop(){i.onStop(o)},trash(){i.onTrash(o)},combineFeatures(){i.onCombineFeatures(o)},uncombineFeatures(){i.onUncombineFeatures(o)},render(t,e){i.toDisplayFeatures(o,t,e)}}}}const ut=function(t){return[].concat(t).filter((t=>void 0!==t))};function ct(){const t=this;if(!(t.ctx.map&&void 0!==t.ctx.map.getSource(c.HOT)))return s();const e=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:e});let r=[],n=[];t.isDirty?n=t.getAllIds():(r=t.getChangedIds().filter((e=>void 0!==t.get(e))),n=t.sources.hot.filter((e=>e.properties.id&&-1===r.indexOf(e.properties.id)&&void 0!==t.get(e.properties.id))).map((t=>t.properties.id))),t.sources.hot=[];const o=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter((t=>{const e=t.properties.id||t.properties.parent;return-1===r.indexOf(e)}));const i=o!==t.sources.cold.length||n.length>0;function a(r,n){const o=t.get(r).internal(e);t.ctx.events.currentModeRender(o,(r=>{r.properties.mode=e,t.sources[n].push(r)}))}function s(){t.isDirty=!1,t.clearChangedIds()}r.forEach((t=>a(t,"hot"))),n.forEach((t=>a(t,"cold"))),i&&t.ctx.map.getSource(c.COLD).setData({type:d.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(c.HOT).setData({type:d.FEATURE_COLLECTION,features:t.sources.hot}),s()}function lt(t){let e;this._features={},this._featureIds=new w,this._selectedFeatureIds=new w,this._selectedCoordinates=[],this._changedFeatureIds=new w,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=()=>{e||(e=requestAnimationFrame((()=>{e=null,ct.call(this),this._emitSelectionChange&&(this.ctx.events.fire(f.SELECTION_CHANGE,{features:this.getSelected().map((t=>t.toGeoJSON())),points:this.getSelectedCoordinates().map((t=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:t.coordinates}})))}),this._emitSelectionChange=!1),this.ctx.events.fire(f.RENDER,{})})))},this.isDirty=!1}function pt(t,e={}){const r=t._selectedCoordinates.filter((e=>t._selectedFeatureIds.has(e.feature_id)));t._selectedCoordinates.length===r.length||e.silent||(t._emitSelectionChange=!0),t._selectedCoordinates=r}lt.prototype.createRenderBatch=function(){const t=this.render;let e=0;return this.render=function(){e++},()=>{this.render=t,e>0&&this.render()}},lt.prototype.setDirty=function(){return this.isDirty=!0,this},lt.prototype.featureCreated=function(t,e={}){this._changedFeatureIds.add(t);if(!0!==(null!=e.silent?e.silent:this.ctx.options.suppressAPIEvents)){const e=this.get(t);this.ctx.events.fire(f.CREATE,{features:[e.toGeoJSON()]})}return this},lt.prototype.featureChanged=function(t,e={}){this._changedFeatureIds.add(t);return!0!==(null!=e.silent?e.silent:this.ctx.options.suppressAPIEvents)&&this.ctx.events.fire(f.UPDATE,{action:e.action?e.action:g.CHANGE_COORDINATES,features:[this.get(t).toGeoJSON()]}),this},lt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},lt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},lt.prototype.getAllIds=function(){return this._featureIds.values()},lt.prototype.add=function(t,e={}){return this._features[t.id]=t,this._featureIds.add(t.id),this.featureCreated(t.id,{silent:e.silent}),this},lt.prototype.delete=function(t,e={}){const r=[];return ut(t).forEach((t=>{this._featureIds.has(t)&&(this._featureIds.delete(t),this._selectedFeatureIds.delete(t),e.silent||-1===r.indexOf(this._features[t])&&r.push(this._features[t].toGeoJSON()),delete this._features[t],this.isDirty=!0)})),r.length&&this.ctx.events.fire(f.DELETE,{features:r}),pt(this,e),this},lt.prototype.get=function(t){return this._features[t]},lt.prototype.getAll=function(){return Object.keys(this._features).map((t=>this._features[t]))},lt.prototype.select=function(t,e={}){return ut(t).forEach((t=>{this._selectedFeatureIds.has(t)||(this._selectedFeatureIds.add(t),this._changedFeatureIds.add(t),e.silent||(this._emitSelectionChange=!0))})),this},lt.prototype.deselect=function(t,e={}){return ut(t).forEach((t=>{this._selectedFeatureIds.has(t)&&(this._selectedFeatureIds.delete(t),this._changedFeatureIds.add(t),e.silent||(this._emitSelectionChange=!0))})),pt(this,e),this},lt.prototype.clearSelected=function(t={}){return this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},lt.prototype.setSelected=function(t,e={}){return t=ut(t),this.deselect(this._selectedFeatureIds.values().filter((e=>-1===t.indexOf(e))),{silent:e.silent}),this.select(t.filter((t=>!this._selectedFeatureIds.has(t))),{silent:e.silent}),this},lt.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},lt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},lt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},lt.prototype.getSelected=function(){return this.getSelectedIds().map((t=>this.get(t)))},lt.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map((t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)})))},lt.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},lt.prototype.setFeatureProperty=function(t,e,r,n={}){this.get(t).setProperty(e,r),this.featureChanged(t,{silent:n.silent,action:g.CHANGE_PROPERTIES})},lt.prototype.storeMapConfig=function(){v.forEach((t=>{this.ctx.map[t]&&(this._mapInitialConfig[t]=this.ctx.map[t].isEnabled())}))},lt.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach((t=>{this._mapInitialConfig[t]?this.ctx.map[t].enable():this.ctx.map[t].disable()}))},lt.prototype.getInitialConfigValue=function(t){return void 0===this._mapInitialConfig[t]||this._mapInitialConfig[t]};const dt=["mode","feature","mouse"];function ht(t){let e=null,r=null;const n={onRemove(){return t.map.off("load",n.connect),clearInterval(r),n.removeLayers(),t.store.restoreMapConfig(),t.ui.removeButtons(),t.events.removeEventListeners(),t.ui.clearMapClasses(),t.boxZoomInitial&&t.map.boxZoom.enable(),t.map=null,t.container=null,t.store=null,e&&e.parentNode&&e.parentNode.removeChild(e),e=null,this},connect(){t.map.off("load",n.connect),clearInterval(r),n.addLayers(),t.store.storeMapConfig(),t.events.addEventListeners()},onAdd(o){if(t.map=o,t.events=function(t){const e=Object.keys(t.options.modes).reduce(((e,r)=>(e[r]=st(t.options.modes[r]),e)),{});let r={},n={};const o={};let i=null,s=null;o.drag=function(e,r){r({point:e.point,time:(new Date).getTime()})?(t.ui.queueMapClasses({mouse:l.DRAG}),s.drag(e)):e.originalEvent.stopPropagation()},o.mousedrag=function(t){o.drag(t,(t=>!j(r,t)))},o.touchdrag=function(t){o.drag(t,(t=>!B(n,t)))},o.mousemove=function(e){if(1===(void 0!==e.originalEvent.buttons?e.originalEvent.buttons:e.originalEvent.which))return o.mousedrag(e);const r=F(e,t);e.featureTarget=r,s.mousemove(e)},o.mousedown=function(e){r={time:(new Date).getTime(),point:e.point};const n=F(e,t);e.featureTarget=n,s.mousedown(e)},o.mouseup=function(e){const n=F(e,t);e.featureTarget=n,j(r,{point:e.point,time:(new Date).getTime()})?s.click(e):s.mouseup(e)},o.mouseout=function(t){s.mouseout(t)},o.touchstart=function(e){if(!t.options.touchEnabled)return;n={time:(new Date).getTime(),point:e.point};const r=A.touch(e,null,t)[0];e.featureTarget=r,s.touchstart(e)},o.touchmove=function(e){if(t.options.touchEnabled)return s.touchmove(e),o.touchdrag(e)},o.touchend=function(e){if(e.originalEvent.preventDefault(),!t.options.touchEnabled)return;const r=A.touch(e,null,t)[0];e.featureTarget=r,B(n,{time:(new Date).getTime(),point:e.point})?s.tap(e):s.touchend(e)};const c=t=>!(8===t||46===t||t>=48&&t<=57);function p(r,n,o={}){s.stop();const u=e[r];if(void 0===u)throw new Error(`${r} is not valid`);i=r;const c=u(t,n);s=a(c,t),o.silent||t.map.fire(f.MODE_CHANGE,{mode:r}),t.store.setDirty(),t.store.render()}o.keydown=function(e){(e.srcElement||e.target).classList.contains(u.CANVAS)&&(8!==e.keyCode&&46!==e.keyCode||!t.options.controls.trash?c(e.keyCode)?s.keydown(e):49===e.keyCode&&t.options.controls.point?p(h.DRAW_POINT):50===e.keyCode&&t.options.controls.line_string?p(h.DRAW_LINE_STRING):51===e.keyCode&&t.options.controls.polygon&&p(h.DRAW_POLYGON):(e.preventDefault(),s.trash()))},o.keyup=function(t){c(t.keyCode)&&s.keyup(t)},o.zoomend=function(){t.store.changeZoom()},o.data=function(e){if("style"===e.dataType){const{setup:e,map:r,options:n,store:o}=t;n.styles.some((t=>r.getLayer(t.id)))||(e.addLayers(),o.setDirty(),o.render())}};const d={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start(){i=t.options.defaultMode,s=a(e[i](t),t)},changeMode:p,actionable:function(e){let r=!1;Object.keys(e).forEach((t=>{if(void 0===d[t])throw new Error("Invalid action type");d[t]!==e[t]&&(r=!0),d[t]=e[t]})),r&&t.map.fire(f.ACTIONABLE,{actions:d})},currentModeName:()=>i,currentModeRender:(t,e)=>s.render(t,e),fire(e,r){t.map&&t.map.fire(e,r)},addEventListeners(){t.map.on("mousemove",o.mousemove),t.map.on("mousedown",o.mousedown),t.map.on("mouseup",o.mouseup),t.map.on("data",o.data),t.map.on("touchmove",o.touchmove),t.map.on("touchstart",o.touchstart),t.map.on("touchend",o.touchend),t.container.addEventListener("mouseout",o.mouseout),t.options.keybindings&&(t.container.addEventListener("keydown",o.keydown),t.container.addEventListener("keyup",o.keyup))},removeEventListeners(){t.map.off("mousemove",o.mousemove),t.map.off("mousedown",o.mousedown),t.map.off("mouseup",o.mouseup),t.map.off("data",o.data),t.map.off("touchmove",o.touchmove),t.map.off("touchstart",o.touchstart),t.map.off("touchend",o.touchend),t.container.removeEventListener("mouseout",o.mouseout),t.options.keybindings&&(t.container.removeEventListener("keydown",o.keydown),t.container.removeEventListener("keyup",o.keyup))},trash(t){s.trash(t)},combineFeatures(){s.combineFeatures()},uncombineFeatures(){s.uncombineFeatures()},getMode:()=>i}}(t),t.ui=function(t){const e={};let r=null,n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null};function i(t){o=Object.assign(o,t)}function a(){if(!t.container)return;const e=[],r=[];dt.forEach((t=>{o[t]!==n[t]&&(e.push(`${t}-${n[t]}`),null!==o[t]&&r.push(`${t}-${o[t]}`))})),e.length>0&&t.container.classList.remove(...e),r.length>0&&t.container.classList.add(...r),n=Object.assign(n,o)}function s(t,e={}){const n=document.createElement("button");return n.className=`${u.CONTROL_BUTTON} ${e.className}`,n.setAttribute("title",e.title),e.container.appendChild(n),n.addEventListener("click",(n=>{if(n.preventDefault(),n.stopPropagation(),n.target===r)return c(),void e.onDeactivate();l(t),e.onActivate()}),!0),n}function c(){r&&(r.classList.remove(u.ACTIVE_BUTTON),r=null)}function l(t){c();const n=e[t];n&&n&&"trash"!==t&&(n.classList.add(u.ACTIVE_BUTTON),r=n)}return{setActiveButton:l,queueMapClasses:i,updateMapClasses:a,clearMapClasses:function(){i({mode:null,feature:null,mouse:null}),a()},addButtons:function(){const r=t.options.controls,n=document.createElement("div");return n.className=`${u.CONTROL_GROUP} ${u.CONTROL_BASE}`,r?(r[p.LINE]&&(e[p.LINE]=s(p.LINE,{container:n,className:u.CONTROL_BUTTON_LINE,title:"LineString tool "+(t.options.keybindings?"(l)":""),onActivate:()=>t.events.changeMode(h.DRAW_LINE_STRING),onDeactivate:()=>t.events.trash()})),r[p.POLYGON]&&(e[p.POLYGON]=s(p.POLYGON,{container:n,className:u.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(t.options.keybindings?"(p)":""),onActivate:()=>t.events.changeMode(h.DRAW_POLYGON),onDeactivate:()=>t.events.trash()})),r[p.POINT]&&(e[p.POINT]=s(p.POINT,{container:n,className:u.CONTROL_BUTTON_POINT,title:"Marker tool "+(t.options.keybindings?"(m)":""),onActivate:()=>t.events.changeMode(h.DRAW_POINT),onDeactivate:()=>t.events.trash()})),r.trash&&(e.trash=s("trash",{container:n,className:u.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{t.events.trash()}})),r.combine_features&&(e.combine_features=s("combineFeatures",{container:n,className:u.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{t.events.combineFeatures()}})),r.uncombine_features&&(e.uncombine_features=s("uncombineFeatures",{container:n,className:u.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{t.events.uncombineFeatures()}})),n):n},removeButtons:function(){Object.keys(e).forEach((t=>{const r=e[t];r.parentNode&&r.parentNode.removeChild(r),delete e[t]}))}}}(t),t.container=o.getContainer(),t.store=new lt(t),e=t.ui.addButtons(),t.options.boxSelect){t.boxZoomInitial=o.boxZoom.isEnabled(),o.boxZoom.disable();const e=o.dragPan.isEnabled();o.dragPan.disable(),o.dragPan.enable(),e||o.dragPan.disable()}return o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval((()=>{o.loaded()&&n.connect()}),16)),t.events.start(),e},addLayers(){t.map.addSource(c.COLD,{data:{type:d.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.map.addSource(c.HOT,{data:{type:d.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.options.styles.forEach((e=>{t.map.addLayer(e)})),t.store.setDirty(!0),t.store.render()},removeLayers(){t.options.styles.forEach((e=>{t.map.getLayer(e.id)&&t.map.removeLayer(e.id)})),t.map.getSource(c.COLD)&&t.map.removeSource(c.COLD),t.map.getSource(c.HOT)&&t.map.removeSource(c.HOT)}};return t.setup=n,n}const ft="#3bb2d0",gt="#fbb03b",yt="#fff",mt=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],gt,ft],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],gt,ft],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":yt}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],gt,ft]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":yt}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":gt}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":gt}}];function vt(t){return function(e){const r=e.featureTarget;return!!r&&(!!r.properties&&r.properties.meta===t)}}function bt(t){return!!t.originalEvent&&(!!t.originalEvent.shiftKey&&0===t.originalEvent.button)}function Et(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===m.ACTIVE&&t.featureTarget.properties.meta===y.FEATURE))}function St(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&(t.featureTarget.properties.active===m.INACTIVE&&t.featureTarget.properties.meta===y.FEATURE))}function Ot(t){return void 0===t.featureTarget}function Ct(t){return!!t.featureTarget&&(!!t.featureTarget.properties&&t.featureTarget.properties.meta===y.FEATURE)}function It(t){const e=t.featureTarget;return!!e&&(!!e.properties&&e.properties.meta===y.VERTEX)}function _t(t){return!!t.originalEvent&&!0===t.originalEvent.shiftKey}function xt(t){return 27===t.keyCode}function Mt(t){return 13===t.keyCode}function Tt(){return!0}function Pt(t,e){this.x=t,this.y=e}Pt.prototype={clone(){return new Pt(this.x,this.y)},add(t){return this.clone()._add(t)},sub(t){return this.clone()._sub(t)},multByPoint(t){return this.clone()._multByPoint(t)},divByPoint(t){return this.clone()._divByPoint(t)},mult(t){return this.clone()._mult(t)},div(t){return this.clone()._div(t)},rotate(t){return this.clone()._rotate(t)},rotateAround(t,e){return this.clone()._rotateAround(t,e)},matMult(t){return this.clone()._matMult(t)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(t){return this.x===t.x&&this.y===t.y},dist(t){return Math.sqrt(this.distSqr(t))},distSqr(t){const e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith(t){return this.angleWithSep(t.x,t.y)},angleWithSep(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult(t){const e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add(t){return this.x+=t.x,this.y+=t.y,this},_sub(t){return this.x-=t.x,this.y-=t.y,this},_mult(t){return this.x*=t,this.y*=t,this},_div(t){return this.x/=t,this.y/=t,this},_multByPoint(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint(t){return this.x/=t.x,this.y/=t.y,this},_unit(){return this._div(this.mag()),this},_perp(){const t=this.y;return this.y=this.x,this.x=-t,this},_rotate(t){const e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,o=r*this.x+e*this.y;return this.x=n,this.y=o,this},_rotateAround(t,e){const r=Math.cos(t),n=Math.sin(t),o=e.x+r*(this.x-e.x)-n*(this.y-e.y),i=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=o,this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Pt},Pt.convert=function(t){if(t instanceof Pt)return t;if(Array.isArray(t))return new Pt(+t[0],+t[1]);if(void 0!==t.x&&void 0!==t.y)return new Pt(+t.x,+t.y);throw new Error("Expected [x, y] or {x, y} point format")};const wt=function(t,e){const r=e.getBoundingClientRect();return new Pt(t.clientX-r.left-(e.clientLeft||0),t.clientY-r.top-(e.clientTop||0))};function Lt(t,e,r,n){return{type:d.FEATURE,properties:{meta:y.VERTEX,parent:t,coord_path:r,active:n?m.ACTIVE:m.INACTIVE},geometry:{type:d.POINT,coordinates:e}}}function At(t,e,r){const n=e.geometry.coordinates,o=r.geometry.coordinates;if(n[1]>O||n[1]<E||o[1]>O||o[1]<E)return null;const i={lng:(n[0]+o[0])/2,lat:(n[1]+o[1])/2};return{type:d.FEATURE,properties:{meta:y.MIDPOINT,parent:t,lng:i.lng,lat:i.lat,coord_path:r.properties.coord_path},geometry:{type:d.POINT,coordinates:[i.lng,i.lat]}}}const Nt=function t(e,r={},n=null){const{type:o,coordinates:i}=e.geometry,a=e.properties&&e.properties.id;let s=[];function u(t,e){let n="",o=null;t.forEach(((t,i)=>{const u=null!=e?`${e}.${i}`:String(i),l=Lt(a,t,u,c(u));if(r.midpoints&&o){const t=At(a,o,l);t&&s.push(t)}o=l;const p=JSON.stringify(t);n!==p&&s.push(l),0===i&&(n=p)}))}function c(t){return!!r.selectedPaths&&-1!==r.selectedPaths.indexOf(t)}return o===d.POINT?s.push(Lt(a,i,n,c(n))):o===d.POLYGON?i.forEach(((t,e)=>{u(t,null!==n?`${n}.${e}`:String(e))})):o===d.LINE_STRING?u(i,n):0===o.indexOf(d.MULTI_PREFIX)&&function(){const n=o.replace(d.MULTI_PREFIX,"");i.forEach(((o,i)=>{const a={type:d.FEATURE,properties:e.properties,geometry:{type:n,coordinates:o}};s=s.concat(t(a,r,i))}))}(),s},Ft={enable(t){setTimeout((()=>{t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()}),0)},disable(t){setTimeout((()=>{t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()}),0)}},{LAT_MIN:Rt,LAT_MAX:Dt,LAT_RENDERED_MIN:kt,LAT_RENDERED_MAX:Ut,LNG_MIN:jt,LNG_MAX:Gt}=t;function Vt(t,e){let r=Rt,n=Dt,o=Rt,i=Dt,a=Gt,s=jt;t.forEach((t=>{const e=function(t){const e={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[t.geometry.type],r=[t.geometry.coordinates].flat(e),n=r.map((t=>t[0])),o=r.map((t=>t[1])),i=t=>Math.min.apply(null,t),a=t=>Math.max.apply(null,t);return[i(n),i(o),a(n),a(o)]}(t),u=e[1],c=e[3],l=e[0],p=e[2];u>r&&(r=u),c<n&&(n=c),c>o&&(o=c),u<i&&(i=u),l<a&&(a=l),p>s&&(s=p)}));const u=e;return r+u.lat>Ut&&(u.lat=Ut-r),o+u.lat>Dt&&(u.lat=Dt-o),n+u.lat<kt&&(u.lat=kt-n),i+u.lat<Rt&&(u.lat=Rt-i),a+u.lng<=jt&&(u.lng+=360*Math.ceil(Math.abs(u.lng)/360)),s+u.lng>=Gt&&(u.lng-=360*Math.ceil(Math.abs(u.lng)/360)),u}function Bt(t,e){const r=Vt(t.map((t=>t.toGeoJSON())),e);t.forEach((t=>{const e=t.getCoordinates(),n=t=>{const e={lng:t[0]+r.lng,lat:t[1]+r.lat};return[e.lng,e.lat]},o=t=>t.map((t=>n(t))),i=t=>t.map((t=>o(t)));let a;t.type===d.POINT?a=n(e):t.type===d.LINE_STRING||t.type===d.MULTI_POINT?a=e.map(n):t.type===d.POLYGON||t.type===d.MULTI_LINE_STRING?a=e.map(o):t.type===d.MULTI_POLYGON&&(a=e.map(i)),t.incomingCoords(a)}))}const Yt={onSetup:function(t){const e={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(e.initiallySelectedFeatureIds.filter((t=>void 0!==this.getFeature(t)))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),e},fireUpdate:function(){this.fire(f.UPDATE,{action:g.MOVE,features:this.getSelected().map((t=>t.toGeoJSON()))})},fireActionable:function(){const t=this.getSelected(),e=t.filter((t=>this.isInstanceOf("MultiFeature",t)));let r=!1;if(t.length>1){r=!0;const e=t[0].type.replace("Multi","");t.forEach((t=>{t.type.replace("Multi","")!==e&&(r=!1)}))}const n=e.length>0,o=t.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:o})},getUniqueIds:function(t){if(!t.length)return[];return t.map((t=>t.properties.id)).filter((t=>void 0!==t)).reduce(((t,e)=>(t.add(e),t)),new w).values()},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),(t.canDragMove||t.canBoxSelect)&&!0===t.initialDragPanState&&this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){Ft.enable(this)},onMouseMove:function(t,e){return Ct(e)&&t.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(t),!0},onMouseOut:function(t){return!t.dragMoving||this.fireUpdate()}};Yt.onTap=Yt.onClick=function(t,e){return Ot(e)?this.clickAnywhere(t,e):vt(y.VERTEX)(e)?this.clickOnVertex(t,e):Ct(e)?this.clickOnFeature(t,e):void 0},Yt.clickAnywhere=function(t){const e=this.getSelectedIds();e.length&&(this.clearSelectedFeatures(),e.forEach((t=>this.doRender(t)))),Ft.enable(this),this.stopExtendedInteractions(t)},Yt.clickOnVertex=function(t,e){this.changeMode(h.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:l.MOVE})},Yt.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},Yt.clickOnFeature=function(t,e){Ft.disable(this),this.stopExtendedInteractions(t);const r=_t(e),n=this.getSelectedIds(),o=e.featureTarget.properties.id,i=this.isSelected(o);if(!r&&i&&this.getFeature(o).type!==d.POINT)return this.changeMode(h.DIRECT_SELECT,{featureId:o});i&&r?(this.deselect(o),this.updateUIClasses({mouse:l.POINTER}),1===n.length&&Ft.enable(this)):!i&&r?(this.select(o),this.updateUIClasses({mouse:l.MOVE})):i||r||(n.forEach((t=>this.doRender(t))),this.setSelected(o),this.updateUIClasses({mouse:l.MOVE})),this.doRender(o)},Yt.onMouseDown=function(t,e){return t.initialDragPanState=this.map.dragPan.isEnabled(),Et(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&bt(e)?this.startBoxSelect(t,e):void 0},Yt.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=wt(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},Yt.onTouchStart=function(t,e){if(Et(e))return this.startOnActiveFeature(t,e)},Yt.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},Yt.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:l.ADD}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add(u.BOX_SELECT),this.map.getContainer().appendChild(t.boxSelectElement));const r=wt(e.originalEvent,this.map.getContainer()),n=Math.min(t.boxSelectStartLocation.x,r.x),o=Math.max(t.boxSelectStartLocation.x,r.x),i=Math.min(t.boxSelectStartLocation.y,r.y),a=Math.max(t.boxSelectStartLocation.y,r.y),s=`translate(${n}px, ${i}px)`;t.boxSelectElement.style.transform=s,t.boxSelectElement.style.WebkitTransform=s,t.boxSelectElement.style.width=o-n+"px",t.boxSelectElement.style.height=a-i+"px"},Yt.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();const r={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};Bt(this.getSelected(),r),t.dragMoveLocation=e.lngLat},Yt.onTouchEnd=Yt.onMouseUp=function(t,e){if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){const r=[t.boxSelectStartLocation,wt(e.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),o=this.getUniqueIds(n).filter((t=>!this.isSelected(t)));o.length&&(this.select(o),o.forEach((t=>this.doRender(t))),this.updateUIClasses({mouse:l.MOVE}))}this.stopExtendedInteractions(t)},Yt.toDisplayFeatures=function(t,e,r){e.properties.active=this.isSelected(e.properties.id)?m.ACTIVE:m.INACTIVE,r(e),this.fireActionable(),e.properties.active===m.ACTIVE&&e.geometry.type!==d.POINT&&Nt(e).forEach(r)},Yt.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Yt.onCombineFeatures=function(){const t=this.getSelected();if(0===t.length||t.length<2)return;const e=[],r=[],n=t[0].type.replace("Multi","");for(let o=0;o<t.length;o++){const i=t[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach((t=>{e.push(t)})):e.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){const t=this.newFeature({type:d.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:e}});this.addFeature(t),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([t.id]),this.fire(f.COMBINE_FEATURES,{createdFeatures:[t.toGeoJSON()],deletedFeatures:r})}this.fireActionable()},Yt.onUncombineFeatures=function(){const t=this.getSelected();if(0===t.length)return;const e=[],r=[];for(let n=0;n<t.length;n++){const o=t[n];this.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((t=>{this.addFeature(t),t.properties=o.properties,e.push(t.toGeoJSON()),this.select([t.id])})),this.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))}e.length>1&&this.fire(f.UNCOMBINE_FEATURES,{createdFeatures:e,deletedFeatures:r}),this.fireActionable()};const Xt=Yt,Jt=vt(y.VERTEX),$t=vt(y.MIDPOINT),Ht={fireUpdate:function(){this.fire(f.UPDATE,{action:g.CHANGE_COORDINATES,features:this.getSelected().map((t=>t.toGeoJSON()))})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){t.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){t.canDragMove&&!0===t.initialDragPanState&&this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);const r=e.featureTarget.properties,n=t.selectedCoordPaths.indexOf(r.coord_path);_t(e)||-1!==n?_t(e)&&-1===n&&t.selectedCoordPaths.push(r.coord_path):t.selectedCoordPaths=[r.coord_path];const o=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(o)},onMidpoint:function(t,e){this.startDragging(t,e);const r=e.featureTarget.properties;t.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),t.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(t,e){return e.map((e=>({feature_id:t,coord_path:e})))},onFeature:function(t,e){0===t.selectedCoordPaths.length?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,r){Bt(this.getSelected(),r),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,r){const n=t.selectedCoordPaths.map((e=>t.feature.getCoordinate(e))),o=Vt(n.map((t=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:t}}))),r);for(let e=0;e<n.length;e++){const r=n[e];t.feature.updateCoordinate(t.selectedCoordPaths[e],r[0]+o.lng,r[1]+o.lat)}},clickNoTarget:function(){this.changeMode(h.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(h.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){const e=t.featureId,r=this.getFeature(e);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===d.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:e,feature:r,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,n.selectedCoordPaths)),this.setSelected(e),Ft.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){Ft.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,r){t.featureId===e.properties.id?(e.properties.active=m.ACTIVE,r(e),Nt(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(r)):(e.properties.active=m.INACTIVE,r(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort(((t,e)=>e.localeCompare(t,"en",{numeric:!0}))).forEach((e=>t.feature.removeCoordinate(e))),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),!1===t.feature.isValid()&&(this.deleteFeature([t.featureId]),this.changeMode(h.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){const r=Et(e),n=Jt(e),o=$t(e),i=0===t.selectedCoordPaths.length;r&&i||n&&!i?this.updateUIClasses({mouse:l.MOVE}):this.updateUIClasses({mouse:l.NONE});return(n||r||o)&&t.dragMoving&&this.fireUpdate(),this.stopDragging(t),!0},onMouseOut:function(t){return t.dragMoving&&this.fireUpdate(),!0}};Ht.onTouchStart=Ht.onMouseDown=function(t,e){return Jt(e)?this.onVertex(t,e):Et(e)?this.onFeature(t,e):$t(e)?this.onMidpoint(t,e):void 0},Ht.onDrag=function(t,e){if(!0!==t.canDragMove)return;t.dragMoving=!0,e.originalEvent.stopPropagation();const r={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,r):this.dragFeature(t,e,r),t.dragMoveLocation=e.lngLat},Ht.onClick=function(t,e){return Ot(e)?this.clickNoTarget(t,e):Et(e)?this.clickActiveFeature(t,e):St(e)?this.clickInactive(t,e):void this.stopDragging(t)},Ht.onTap=function(t,e){return Ot(e)?this.clickNoTarget(t,e):Et(e)?this.clickActiveFeature(t,e):St(e)?this.clickInactive(t,e):void 0},Ht.onTouchEnd=Ht.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)};const qt=Ht,Zt={onSetup:function(){const t=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(p.POINT),this.setActionableState({trash:!0}),{point:t}},stopDrawingAndRemove:function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)}};Zt.onTap=Zt.onClick=function(t,e){this.updateUIClasses({mouse:l.MOVE}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.fire(f.CREATE,{features:[t.point.toGeoJSON()]}),this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.point.id]})},Zt.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},Zt.toDisplayFeatures=function(t,e,r){const n=e.properties.id===t.point.id;if(e.properties.active=n?m.ACTIVE:m.INACTIVE,!n)return r(e)},Zt.onTrash=Zt.stopDrawingAndRemove,Zt.onKeyUp=function(t,e){if(xt(e)||Mt(e))return this.stopDrawingAndRemove(t,e)};const zt=Zt;const Wt=function(t,e){return!!t.lngLat&&(t.lngLat.lng===e[0]&&t.lngLat.lat===e[1])},Kt={onSetup:function(){const t=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),Ft.disable(this),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(p.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&Wt(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:l.ADD}),t.polygon.updateCoordinate(`0.${t.currentVertexPosition}`,e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate(`0.${t.currentVertexPosition}`,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate(`0.${t.currentVertexPosition}`,e.lngLat.lng,e.lngLat.lat),It(e)&&this.updateUIClasses({mouse:l.POINTER})}};Kt.onTap=Kt.onClick=function(t,e){return It(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},Kt.onKeyUp=function(t,e){xt(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)):Mt(e)&&this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},Kt.onStop=function(t){this.updateUIClasses({mouse:l.NONE}),Ft.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.polygon.id)&&(t.polygon.removeCoordinate(`0.${t.currentVertexPosition}`),t.polygon.isValid()?this.fire(f.CREATE,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},Kt.toDisplayFeatures=function(t,e,r){const n=e.properties.id===t.polygon.id;if(e.properties.active=n?m.ACTIVE:m.INACTIVE,!n)return r(e);if(0===e.geometry.coordinates.length)return;const o=e.geometry.coordinates[0].length;if(!(o<3)){if(e.properties.meta=y.FEATURE,r(Lt(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),o>3){const n=e.geometry.coordinates[0].length-3;r(Lt(t.polygon.id,e.geometry.coordinates[0][n],`0.${n}`,!1))}if(o<=4){const t=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(r({type:d.FEATURE,properties:e.properties,geometry:{coordinates:t,type:d.LINE_STRING}}),3===o)return}return r(e)}},Kt.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)};const Qt=Kt,te={onSetup:function(t){const e=(t=t||{}).featureId;let r,n,o="forward";if(e){if(r=this.getFeature(e),!r)throw new Error("Could not find a feature with the provided featureId");let i=t.from;if(i&&"Feature"===i.type&&i.geometry&&"Point"===i.geometry.type&&(i=i.geometry),i&&"Point"===i.type&&i.coordinates&&2===i.coordinates.length&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===i[0]&&r.coordinates[a][1]===i[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else{if(r.coordinates[0][0]!==i[0]||r.coordinates[0][1]!==i[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");o="backwards",n=0,r.addCoordinate(n,...r.coordinates[0])}}else r=this.newFeature({type:d.FEATURE,properties:{},geometry:{type:d.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Ft.disable(this),this.updateUIClasses({mouse:l.ADD}),this.activateUIButton(p.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:o}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&Wt(e,t.line.coordinates[t.currentVertexPosition-1])||"backwards"===t.direction&&Wt(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:l.ADD}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),"forward"===t.direction?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),It(e)&&this.updateUIClasses({mouse:l.POINTER})}};te.onTap=te.onClick=function(t,e){if(It(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},te.onKeyUp=function(t,e){Mt(e)?this.changeMode(h.SIMPLE_SELECT,{featureIds:[t.line.id]}):xt(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT))},te.onStop=function(t){Ft.enable(this),this.activateUIButton(),void 0!==this.getFeature(t.line.id)&&(t.line.removeCoordinate(`${t.currentVertexPosition}`),t.line.isValid()?this.fire(f.CREATE,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},te.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)},te.toDisplayFeatures=function(t,e,r){const n=e.properties.id===t.line.id;if(e.properties.active=n?m.ACTIVE:m.INACTIVE,!n)return r(e);e.geometry.coordinates.length<2||(e.properties.meta=y.FEATURE,r(Lt(t.line.id,e.geometry.coordinates["forward"===t.direction?e.geometry.coordinates.length-2:1],""+("forward"===t.direction?e.geometry.coordinates.length-2:1),!1)),r(e))};const ee={simple_select:Xt,direct_select:qt,draw_point:zt,draw_polygon:Qt,draw_line_string:te},re={defaultMode:h.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:mt,modes:ee,controls:{},userProperties:!1,suppressAPIEvents:!0},ne={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},oe={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ie(t,e){return t.map((t=>t.source?t:Object.assign({},t,{id:`${t.id}.${e}`,source:"hot"===e?c.HOT:c.COLD})))}var ae=r(17),se=r(186);function ue(t,e){return t.length===e.length&&JSON.stringify(t.map((t=>t)).sort())===JSON.stringify(e.map((t=>t)).sort())}const ce={Polygon:K,LineString:z,Point:q,MultiPolygon:rt,MultiLineString:rt,MultiPoint:rt};const le=function(t,e){const r={options:t=function(t={}){let e=Object.assign({},t);return t.controls||(e.controls={}),!1===t.displayControlsDefault?e.controls=Object.assign({},oe,t.controls):e.controls=Object.assign({},ne,t.controls),e=Object.assign({},re,e),e.styles=ie(e.styles,"cold").concat(ie(e.styles,"hot")),e}(t)};e=function(t,e){e.modes=h;const r=void 0===t.options.suppressAPIEvents||!!t.options.suppressAPIEvents;return e.getFeatureIdsAt=function(e){return A.click({point:e},null,t).map((t=>t.properties.id))},e.getSelectedIds=function(){return t.store.getSelectedIds()},e.getSelected=function(){return{type:d.FEATURE_COLLECTION,features:t.store.getSelectedIds().map((e=>t.store.get(e))).map((t=>t.toGeoJSON()))}},e.getSelectedPoints=function(){return{type:d.FEATURE_COLLECTION,features:t.store.getSelectedCoordinates().map((t=>({type:d.FEATURE,properties:{},geometry:{type:d.POINT,coordinates:t.coordinates}})))}},e.set=function(r){if(void 0===r.type||r.type!==d.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=t.store.createRenderBatch();let o=t.store.getAllIds().slice();const i=e.add(r),a=new w(i);return o=o.filter((t=>!a.has(t))),o.length&&e.delete(o),n(),i},e.add=function(e){const n=JSON.parse(JSON.stringify(se(e))).features.map((e=>{if(e.id=e.id||X(),null===e.geometry)throw new Error("Invalid geometry: null");if(void 0===t.store.get(e.id)||t.store.get(e.id).type!==e.geometry.type){const n=ce[e.geometry.type];if(void 0===n)throw new Error(`Invalid geometry type: ${e.geometry.type}.`);const o=new n(t,e);t.store.add(o,{silent:r})}else{const n=t.store.get(e.id),o=n.properties;n.properties=e.properties,ae(o,e.properties)||t.store.featureChanged(n.id,{silent:r}),ae(n.getCoordinates(),e.geometry.coordinates)||n.incomingCoords(e.geometry.coordinates)}return e.id}));return t.store.render(),n},e.get=function(e){const r=t.store.get(e);if(r)return r.toGeoJSON()},e.getAll=function(){return{type:d.FEATURE_COLLECTION,features:t.store.getAll().map((t=>t.toGeoJSON()))}},e.delete=function(n){return t.store.delete(n,{silent:r}),e.getMode()!==h.DIRECT_SELECT||t.store.getSelectedIds().length?t.store.render():t.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:r}),e},e.deleteAll=function(){return t.store.delete(t.store.getAllIds(),{silent:r}),e.getMode()===h.DIRECT_SELECT?t.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:r}):t.store.render(),e},e.changeMode=function(n,o={}){return n===h.SIMPLE_SELECT&&e.getMode()===h.SIMPLE_SELECT?(ue(o.featureIds||[],t.store.getSelectedIds())||(t.store.setSelected(o.featureIds,{silent:r}),t.store.render()),e):(n===h.DIRECT_SELECT&&e.getMode()===h.DIRECT_SELECT&&o.featureId===t.store.getSelectedIds()[0]||t.events.changeMode(n,o,{silent:r}),e)},e.getMode=function(){return t.events.getMode()},e.trash=function(){return t.events.trash({silent:r}),e},e.combineFeatures=function(){return t.events.combineFeatures({silent:r}),e},e.uncombineFeatures=function(){return t.events.uncombineFeatures({silent:r}),e},e.setFeatureProperty=function(n,o,i){return t.store.setFeatureProperty(n,o,i,{silent:r}),e},e}(r,e),r.api=e;const n=ht(r);return e.onAdd=n.onAdd,e.onRemove=n.onRemove,e.types=p,e.options=t,e};function pe(t){le(t,this)}pe.modes=ee,pe.constants=t,pe.lib=o;const de=pe;var he=6371008.8,fe={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*he,kilometers:6371.0088,kilometres:6371.0088,meters:he,metres:he,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:he/1852,radians:1,yards:6967335.223679999};function ge(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function ye(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_e(t[0])||!_e(t[1]))throw new Error("coordinates must contain numbers");return ge({type:"Point",coordinates:t},e,r)}function me(t,e,r){void 0===r&&(r={});for(var n=0,o=t;n<o.length;n++){var i=o[n];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return ge({type:"Polygon",coordinates:t},e,r)}function ve(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return ge({type:"LineString",coordinates:t},e,r)}function be(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function Ee(t,e,r){return void 0===r&&(r={}),ge({type:"MultiLineString",coordinates:t},e,r)}function Se(t,e){void 0===e&&(e="kilometers");var r=fe[e];if(!r)throw new Error(e+" units is invalid");return t*r}function Oe(t,e){void 0===e&&(e="kilometers");var r=fe[e];if(!r)throw new Error(e+" units is invalid");return t/r}function Ce(t){return 180*(t%(2*Math.PI))/Math.PI}function Ie(t){return t%360*Math.PI/180}function _e(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function xe(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Me(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Te(t){return"Feature"===t.type?t.geometry:t}function Pe(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=xe(t),o=Te(e),i=o.type,a=e.bbox,s=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,a))return!1;"Polygon"===i&&(s=[s]);for(var u=!1,c=0;c<s.length&&!u;c++)if(we(n,s[c][0],r.ignoreBoundary)){for(var l=!1,p=1;p<s[c].length&&!l;)we(n,s[c][p],!r.ignoreBoundary)&&(l=!0),p++;l||(u=!0)}return u}function we(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,i=e.length-1;o<e.length;i=o++){var a=e[o][0],s=e[o][1],u=e[i][0],c=e[i][1];if(t[1]*(a-u)+s*(u-t[0])+c*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(c-t[1])<=0)return!r;s>t[1]!=c>t[1]&&t[0]<(u-a)*(t[1]-s)/(c-s)+a&&(n=!n)}return n}function Le(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function Ae(t,e){var r,n,o,i,a,s,u,c,l,p,d=0,h="FeatureCollection"===t.type,f="Feature"===t.type,g=h?t.features.length:1;for(r=0;r<g;r++){for(s=h?t.features[r].geometry:f?t.geometry:t,c=h?t.features[r].properties:f?t.properties:{},l=h?t.features[r].bbox:f?t.bbox:void 0,p=h?t.features[r].id:f?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,d,c,l,p))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],d,c,l,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,l,p))return!1;d++}}function Ne(t,e){Ae(t,(function(t,r,n,o,i){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(ge(t,n,{bbox:o,id:i}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u];if(!1===e(ge({type:a,coordinates:c},n),r,u))return!1}}))}const Fe=function(t){if(!t)throw new Error("geojson is required");var e=[];return Ne(t,(function(t){!function(t,e){var r=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":r=Me(n);break;case"LineString":r=[Me(n)]}r.forEach((function(r){var n=function(t,e){var r=[];return t.reduce((function(t,n){var o,i,a,s,u,c,l=ve([t,n],e);return l.bbox=(i=n,a=(o=t)[0],s=o[1],u=i[0],c=i[1],[a<u?a:u,s<c?s:c,a>u?a:u,s>c?s:c]),r.push(l),n})),r}(r,t.properties);n.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),be(e)};var Re=r(945);function De(t,e){var r=Me(t),n=Me(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=r[0][0],i=r[0][1],a=r[1][0],s=r[1][1],u=n[0][0],c=n[0][1],l=n[1][0],p=n[1][1],d=(p-c)*(a-o)-(l-u)*(s-i),h=(l-u)*(i-c)-(p-c)*(o-u),f=(a-o)*(i-c)-(s-i)*(o-u);if(0===d)return null;var g=h/d,y=f/d;return g>=0&&g<=1&&y>=0&&y<=1?ye([o+g*(a-o),i+g*(s-i)]):null}const ke=function(t,e){var r={},n=[];if("LineString"===t.type&&(t=ge(t)),"LineString"===e.type&&(e=ge(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=De(t,e);return o&&n.push(o),be(n)}var i=Re();return i.load(Fe(e)),Le(Fe(t),(function(t){Le(i.search(t),(function(e){var o=De(t,e);if(o){var i=Me(o).join(",");r[i]||(r[i]=!0,n.push(o))}}))})),be(n)};function Ue(t,e){void 0===e&&(e={});var r=Te(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),r.type){case"Polygon":return function(t,e){void 0===e&&(e={});var r=Te(t),n=r.coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{};return je(n,o)}(r,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var r=Te(t),n=r.coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{},i=[];return n.forEach((function(t){i.push(je(t,o))})),be(i)}(r,e);default:throw new Error("invalid poly")}}function je(t,e){return t.length>1?Ee(t,e):ve(t[0],e)}function Ge(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(Be(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}function Ve(t,e){for(var r=0,n=e.coordinates;r<n.length;r++){if(Pe(n[r],t))return!0}return ke(e,Ue(t)).features.length>0}function Be(t,e,r){var n=r[0]-t[0],o=r[1]-t[1],i=e[0]-t[0],a=e[1]-t[1];return 0==n*a-o*i&&(Math.abs(i)>=Math.abs(a)?i>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:a>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1])}const Ye=function(t,e){var r=!0;return Ne(t,(function(t){Ne(e,(function(e){if(!1===r)return!1;r=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return r=t.coordinates,n=e.coordinates,!(r[0]===n[0]&&r[1]===n[1]);case"LineString":return!Ge(e,t);case"Polygon":return!Pe(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ge(t,e);case"LineString":return!function(t,e){if(ke(t,e).features.length>0)return!0;return!1}(t,e);case"Polygon":return!Ve(e,t)}break;case"Polygon":switch(e.type){case"Point":return!Pe(e,t);case"LineString":return!Ve(t,e);case"Polygon":return!function(t,e){for(var r=0,n=t.coordinates[0];r<n.length;r++){if(Pe(n[r],e))return!0}for(var o=0,i=e.coordinates[0];o<i.length;o++){if(Pe(i[o],t))return!0}var a=ke(Ue(t),Ue(e));if(a.features.length>0)return!0;return!1}(e,t)}}var r,n;return!1}(t.geometry,e.geometry)}))})),r};const Xe=function(t,e,r){void 0===r&&(r={});var n=xe(t),o=xe(e),i=Ie(o[1]-n[1]),a=Ie(o[0]-n[0]),s=Ie(n[1]),u=Ie(o[1]),c=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(u);return Se(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)};function Je(t,e,r){if(void 0===r&&(r={}),!0===r.final)return function(t,e){var r=Je(e,t);return r=(r+180)%360}(t,e);var n=xe(t),o=xe(e),i=Ie(n[0]),a=Ie(o[0]),s=Ie(n[1]),u=Ie(o[1]),c=Math.sin(a-i)*Math.cos(u),l=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(a-i);return Ce(Math.atan2(c,l))}function $e(t,e,r,n){void 0===n&&(n={});var o=xe(t),i=Ie(o[0]),a=Ie(o[1]),s=Ie(r),u=Oe(e,n.units),c=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return ye([Ce(i+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(c))),Ce(c)],n.properties)}const He=function(t,e,r){void 0===r&&(r={});var n=ye([1/0,1/0],{dist:1/0}),o=0;return Ne(t,(function(t){for(var i=Me(t),a=0;a<i.length-1;a++){var s=ye(i[a]);s.properties.dist=Xe(e,s,r);var u=ye(i[a+1]);u.properties.dist=Xe(e,u,r);var c=Xe(s,u,r),l=Math.max(s.properties.dist,u.properties.dist),p=Je(s,u),d=$e(e,l,p+90,r),h=$e(e,l,p-90,r),f=ke(ve([d.geometry.coordinates,h.geometry.coordinates]),ve([s.geometry.coordinates,u.geometry.coordinates])),g=null;f.features.length>0&&((g=f.features[0]).properties.dist=Xe(e,g,r),g.properties.location=o+Xe(s,g,r)),s.properties.dist<n.properties.dist&&((n=s).properties.index=a,n.properties.location=o),u.properties.dist<n.properties.dist&&((n=u).properties.index=a+1,n.properties.location=o+c),g&&g.properties.dist<n.properties.dist&&((n=g).properties.index=a),o+=c}})),n};function qe(t){var e={type:"Feature"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:e[r]=t[r]}})),e.properties=Ze(t.properties),e.geometry=ze(t.geometry),e}function Ze(t){var e={};return t?(Object.keys(t).forEach((function(r){var n=t[r];"object"==typeof n?null===n?e[r]=null:Array.isArray(n)?e[r]=n.map((function(t){return t})):e[r]=Ze(n):e[r]=n})),e):e}function ze(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return ze(t)})),e):(e.coordinates=We(t.coordinates),e)}function We(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return We(t)}))}const Ke=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return qe(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"features":return;default:e[r]=t[r]}})),e.features=t.features.map((function(t){return qe(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return ze(t);default:throw new Error("unknown GeoJSON type")}};const Qe=function(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var r,n=1/0,o=0;return Le(e,(function(e,r){var i=Xe(t,e);i<n&&(o=r,n=i)})),(r=Ke(e.features[o])).properties.featureIndex=o,r.properties.distanceToPoint=n,r};const tr=function(t,e){return $e(t,Xe(t,e)/2,Je(t,e))};function er(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return rr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var nr=de.constants.geojsonTypes,or={VERTICAL_GUIDE:"VERTICAL_GUIDE",HORIZONTAL_GUIDE:"HORIZONTAL_GUIDE"},ir=function(t,e,r,n){var o=t.getCanvas(),i=o.width,a=o.height,s=t.project(r),u=s.x,c=s.y;(u>0&&u<i&&c>0&&c<a||n)&&e.push(r)},ar=function(t,e,r){var n=e.getAll().features,o=[],i=function(){var e=t.getCanvas(),r=e.width,n=e.height,o=(t.unproject([0,0]).toArray(),t.unproject([r,0]).toArray());t.unproject([r,n]).toArray();return function(t,e){void 0===e&&(e={});var r=Number(t[0]),n=Number(t[1]),o=Number(t[2]),i=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,n];return me([[a,[o,n],[o,i],[r,i],a]],e.properties,{bbox:t,id:e.id})}([t.unproject([0,n]).toArray(),o].flat())}(),a=[],s=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e))throw Error("Your array is not an array");Array.isArray(e[0])?e.forEach((function(t){s(t)})):2===e.length&&ir(t,a,e,r)};return n.forEach((function(t){t.id!==r.id?t.id!==or.HORIZONTAL_GUIDE&&t.id!==or.VERTICAL_GUIDE&&(s(t.geometry.coordinates),Ye(i,t)||o.push(t)):r.type===nr.POLYGON&&s(t.geometry.coordinates[0].slice(0,-2),!0)})),[o,a]};function sr(t,e){var r=t.map((function(t){return{feature:t,point:He(t,e)}}));return r.sort((function(t,e){return t.point.properties.dist-e.point.properties.dist})),{feature:r[0].feature,point:r[0].point}}var ur=function(t,e){var r={};return e.forEach((function(e,n){var o=function(t,e){var r,n=[t.lng,t.lat],o="Point"===e.geometry.type,i="Polygon"===e.geometry.type,a="MultiPolygon"===e.geometry.type,s="MultiPoint"===e.geometry.type,u=void 0,c=Me(e);if(o){var l=er(c,2);return{latlng:{lng:l[0],lat:l[1]},distance:Xe(c,n)}}if(s){var p=Qe(n,be(c.map((function(t){return ye(t)})))),d=p.geometry.coordinates;return{latlng:{lng:d[0],lat:d[1]},distance:p.properties.distanceToPoint}}if(u=i||a?Ue(e):e,i){var h=sr("LineString"===u.geometry.type?[ve(u.geometry.coordinates)]:u.geometry.coordinates.map((function(t){return ve(t)})),n);u=h.feature,r=h.point}else if(a){var f=sr(u.features.map((function(t){return"LineString"===t.geometry.type?[t.geometry.coordinates]:t.geometry.coordinates})).flatMap((function(t){return t})).map((function(t){return ve(t)})),n);u=f.feature,r=f.point}else r=He(u,n);var g=er(r.geometry.coordinates,2),y=g[0],m=g[1],v=r.properties.index;return v+1===u.geometry.coordinates.length&&v--,{latlng:{lng:y,lat:m},segment:u.geometry.coordinates.slice(v,v+2),distance:r.properties.dist,isMarker:o}}(t,e);(void 0===r.distance||o.distance<r.distance)&&((r=o).layer=e)})),r};var cr=function(t,e,r){return!Array.isArray(t.segment)?function(t){return t.latlng}(t):function(t,e,r){var n=null!=e?e:{},o=n.snapToMidPoints,i=void 0!==o&&o,a=n.snapToNodal,s=void 0===a||a,u=n.snapToEndPoints,c=void 0===u||u,l=n.snapToLines,p=void 0===l||l,d=n.snapVertexPriorityDistance,h=void 0===d?1.25:d,f=t.layer.geometry,g=t.segment[0],y=t.segment[1],m=[t.latlng.lng,t.latlng.lat],v=Xe(g,m),b=Xe(y,m),E=v<b?g:y,S=v<b?v:b,O=!1;if(i){var C=tr(g,y).geometry.coordinates,I=Xe(C,m);I<v&&I<b&&(E=C,S=I,O=!0)}var _,x=h,M=("LineString"===f.type?[f.coordinates[0],f.coordinates[f.coordinates.length-1]]:[]).find((function(t){return t[0]===E[0]&&t[1]===E[1]}));_=S>=x?p?m:r:O||s||(!c||M)&&c?E:r;var T=er(_,2);return{lng:T[0],lat:T[1]}}(t,e,r)},lr=function(t,e){var r,n,o,i,a,s,u,c,l,p,d,h,f=e.lngLat.lng,g=e.lngLat.lat;if(e.originalEvent.altKey)return t.showVerticalSnapLine=!1,t.showHorizontalSnapLine=!1,{lng:f,lat:g};if(t.snapList.length<=0)return{lng:f,lat:g};if(t.options.snap){if(r=ur({lng:f,lat:g},t.snapList),0===Object.keys(r).length)return!1;o=r.isMarker?r.latlng:cr(r,t.options.snapOptions,[f,g]),n=(t.options.snapOptions&&t.options.snapOptions.snapPx||15)*(i=o.lat,a=t.map.getZoom(),s=i*(Math.PI/180),40075017*Math.cos(s)/Math.pow(2,a+8))}if(t.options.guides){var y=(l=t.vertices,p=e.lngLat,d=[],h=[],l.forEach((function(t){d.push(t[0]),h.push(t[1])})),{verticalPx:d.find((function(t){return Math.abs(t-p.lng)<.009})),horizontalPx:h.find((function(t){return Math.abs(t-p.lat)<.009}))});if(c=y.horizontalPx,u=y.verticalPx){var m={lng:u,lat:e.lngLat.lat+10},v={lng:u,lat:e.lngLat.lat-10};t.verticalGuide.updateCoordinate(0,m.lng,m.lat),t.verticalGuide.updateCoordinate(1,v.lng,v.lat)}if(c){var b={lng:e.lngLat.lng+10,lat:c},E={lng:e.lngLat.lng-10,lat:c};t.horizontalGuide.updateCoordinate(0,b.lng,b.lat),t.horizontalGuide.updateCoordinate(1,E.lng,E.lat)}t.showVerticalSnapLine=!!u,t.showHorizontalSnapLine=!!c}return r&&1e3*r.distance<n?o:u||c?(u&&(f=u),c&&(g=c),{lng:f,lat:g}):{lng:f,lat:g}},pr=function(t){return{id:t,type:nr.FEATURE,properties:{isSnapGuide:"true"},geometry:{type:nr.LINE_STRING,coordinates:[]}}},dr=function(t,e){return!(e.properties.id!==or.VERTICAL_GUIDE||t.options.guides&&t.showVerticalSnapLine)||!(e.properties.id!==or.HORIZONTAL_GUIDE||t.options.guides&&t.showHorizontalSnapLine)};function hr(t){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hr(t)}function fr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return gr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function yr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mr(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=hr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vr=de.lib.doubleClickZoom,br=de.modes.draw_point,Er=de.constants,Sr=Er.geojsonTypes,Or=Er.cursors,Cr=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?yr(Object(r),!0).forEach((function(e){mr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},br);Cr.onSetup=function(t){var e=this,r=this.newFeature({type:Sr.FEATURE,properties:{},geometry:{type:Sr.POINT,coordinates:[[]]}}),n=this.newFeature(pr(or.VERTICAL_GUIDE)),o=this.newFeature(pr(or.HORIZONTAL_GUIDE));this.addFeature(r),this.addFeature(n),this.addFeature(o);var i=this.getSelected();this.clearSelectedFeatures(),vr.disable(this);var a=fr(ar(this.map,this._ctx.api,r),2),s=a[0],u=a[1],c={map:this.map,point:r,vertices:u,snapList:s,selectedFeatures:i,verticalGuide:n,horizontalGuide:o};c.options=this._ctx.options;var l=function(){var t=fr(ar(e.map,e._ctx.api,r),2),n=t[0],o=t[1];c.vertices=o,c.snapList=n};c.updateSnapList=l;var p=function(t){c.options=t};return c.optionsChangedCallBAck=p,this.map.on("moveend",l),this.map.on("draw.snap.update_snapList",l),this.map.on("draw.snap.options_changed",p),c},Cr.onClick=function(t){br.onClick.call(this,t,{lngLat:{lng:t.snappedLng,lat:t.snappedLat}})},Cr.onMouseMove=function(t,e){var r=lr(t,e),n=r.lng,o=r.lat;t.snappedLng=n,t.snappedLat=o,t.lastVertex&&t.lastVertex[0]===n&&t.lastVertex[1]===o?this.updateUIClasses({mouse:Or.POINTER}):this.updateUIClasses({mouse:Or.ADD})},Cr.toDisplayFeatures=function(t,e,r){dr(t,e)||br.toDisplayFeatures(t,e,r)},Cr.onStop=function(t){this.deleteFeature(or.VERTICAL_GUIDE,{silent:!0}),this.deleteFeature(or.HORIZONTAL_GUIDE,{silent:!0}),this.map.off("moveend",t.updateSnapList),this.map.off("draw.snap.update_snapList",t.updateSnapList),br.onStop.call(this,t)};const Ir=Cr;function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function xr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Mr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Tr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Pr(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=_r(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_r(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wr=de.constants,Lr=wr.geojsonTypes,Ar=wr.modes,Nr=wr.cursors,Fr=de.lib.doubleClickZoom,Rr=de.modes.draw_line_string,Dr=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Tr(Object(r),!0).forEach((function(e){Pr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Rr);Dr.onSetup=function(t){var e=this,r=this.newFeature({type:Lr.FEATURE,properties:{},geometry:{type:Lr.LINE_STRING,coordinates:[[]]}}),n=this.newFeature(pr(or.VERTICAL_GUIDE)),o=this.newFeature(pr(or.HORIZONTAL_GUIDE));this.addFeature(r),this.addFeature(n),this.addFeature(o);var i=this.getSelected();this.clearSelectedFeatures(),Fr.disable(this);var a=xr(ar(this.map,this._ctx.api,r),2),s=a[0],u=a[1],c={map:this.map,line:r,currentVertexPosition:0,vertices:u,snapList:s,selectedFeatures:i,verticalGuide:n,horizontalGuide:o,direction:"forward"};c.options=this._ctx.options;var l=function(){var t=xr(ar(e.map,e._ctx.api,r),2),n=t[0],o=t[1];c.vertices=o,c.snapList=n};c.updateSnapList=l;var p=function(t){c.options=t};return c.optionsChangedCallBAck=p,this.map.on("moveend",l),this.map.on("draw.snap.update_snapList",l),this.map.on("draw.snap.options_changed",p),c},Dr.onClick=function(t){var e=t.snappedLng,r=t.snappedLat;if(t.currentVertexPosition>0){var n=t.line.coordinates[t.currentVertexPosition-1];if(t.lastVertex=n,n[0]===e&&n[1]===r)return this.changeMode(Ar.SIMPLE_SELECT,{featureIds:[t.line.id]})}ir(t.map,t.vertices,{lng:e,lat:r}),t.line.updateCoordinate(t.currentVertexPosition,e,r),t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e,r)},Dr.onMouseMove=function(t,e){var r=lr(t,e),n=r.lng,o=r.lat;t.line.updateCoordinate(t.currentVertexPosition,n,o),t.snappedLng=n,t.snappedLat=o,t.lastVertex&&t.lastVertex[0]===n&&t.lastVertex[1]===o?this.updateUIClasses({mouse:Nr.POINTER}):this.updateUIClasses({mouse:Nr.ADD})},Dr.toDisplayFeatures=function(t,e,r){dr(t,e)||Rr.toDisplayFeatures(t,e,r)},Dr.onStop=function(t){this.deleteFeature(or.VERTICAL_GUIDE,{silent:!0}),this.deleteFeature(or.HORIZONTAL_GUIDE,{silent:!0}),this.map.off("moveend",t.updateSnapList),this.map.off("draw.snap.update_snapList",t.updateSnapList),Rr.onStop.call(this,t)};const kr=Dr;function Ur(t){return Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ur(t)}function jr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Gr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Br(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Ur(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ur(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ur(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Yr=de.constants,Xr=Yr.geojsonTypes,Jr=Yr.modes,$r=Yr.cursors,Hr=de.lib.doubleClickZoom,qr=de.modes.draw_polygon,Zr=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Vr(Object(r),!0).forEach((function(e){Br(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},qr);Zr.onSetup=function(t){var e=this,r=this.newFeature({type:Xr.FEATURE,properties:{},geometry:{type:Xr.POLYGON,coordinates:[[]]}}),n=this.newFeature(pr(or.VERTICAL_GUIDE)),o=this.newFeature(pr(or.HORIZONTAL_GUIDE));this.addFeature(r),this.addFeature(n),this.addFeature(o);var i=this.getSelected();this.clearSelectedFeatures(),Hr.disable(this);var a=jr(ar(this.map,this._ctx.api,r),2),s=a[0],u=a[1],c={map:this.map,polygon:r,currentVertexPosition:0,vertices:u,snapList:s,selectedFeatures:i,verticalGuide:n,horizontalGuide:o};c.options=Object.assign(this._ctx.options,{overlap:!0});var l=function(){var t=jr(ar(e.map,e._ctx.api,r),2),n=t[0],o=t[1];c.vertices=o,c.snapList=n};c.updateSnapList=l;var p=function(t){c.options=t};return c.optionsChangedCallBAck=p,this.map.on("moveend",l),this.map.on("draw.snap.update_snapList",l),this.map.on("draw.snap.options_changed",p),c},Zr.onClick=function(t){var e=t.snappedLng,r=t.snappedLat;if(t.currentVertexPosition>0){var n=t.polygon.coordinates[0][t.currentVertexPosition-1];if(t.lastVertex=n,n[0]===e&&n[1]===r)return this.changeMode(Jr.SIMPLE_SELECT,{featureIds:[t.polygon.id]})}ir(t.map,t.vertices,{lng:e,lat:r}),t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e,r),t.currentVertexPosition++,t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),e,r)},Zr.onMouseMove=function(t,e){var r=lr(t,e),n=r.lng,o=r.lat;t.polygon.updateCoordinate("0.".concat(t.currentVertexPosition),n,o),t.snappedLng=n,t.snappedLat=o,t.lastVertex&&t.lastVertex[0]===n&&t.lastVertex[1]===o?this.updateUIClasses({mouse:$r.POINTER}):this.updateUIClasses({mouse:$r.ADD})},Zr.toDisplayFeatures=function(t,e,r){dr(t,e)||qr.toDisplayFeatures(t,e,r)},Zr.onStop=function(t){this.deleteFeature(or.VERTICAL_GUIDE,{silent:!0}),this.deleteFeature(or.HORIZONTAL_GUIDE,{silent:!0}),this.map.off("moveend",t.updateSnapList),this.map.off("draw.snap.update_snapList",t.updateSnapList),this.map.off("draw.snap.options_changed",t.optionsChangedCallBAck);var e=t.polygon;if(t.options.overlap)qr.onStop.call(this,t);else{var r=this._ctx.store.getAll();try{var n=e;r.forEach((function(t){if(e.id===t.id)return!1;var r,o;(r=n,o=!1,Ne(t,(function(t){Ne(r,(function(e){if(!0===o)return!0;o=!Ye(t.geometry,e.geometry)}))})),o)&&(n=turf.difference(n,t))})),t.polygon.coordinates=n.coordinates||n.geometry.coordinates}catch(e){return qr.onStop.call(this,t),void this.deleteFeature([t.polygon.id],{silent:!0})}var o=t.polygon.removeCoordinate;t.polygon.removeCoordinate=function(){},qr.onStop.call(this,t),t.polygon.removeCoordinate=o.bind(t.polygon)}};const zr=Zr;function Wr(t){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wr(t)}function Kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Qr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function tn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function en(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Wr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Wr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var rn=de.lib.doubleClickZoom,nn=de.modes.direct_select,on=de.constants,an=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tn(Object(r),!0).forEach((function(e){en(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},nn);an.onSetup=function(t){var e=this,r=t.featureId,n=this.getFeature(r);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===on.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");var o=Kr(ar(this.map,this._ctx.api,n),2),i=o[0],a=o[1],s=this.newFeature(pr(or.VERTICAL_GUIDE)),u=this.newFeature(pr(or.HORIZONTAL_GUIDE));this.addFeature(s),this.addFeature(u);var c={map:this.map,featureId:r,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[],vertices:a,snapList:i,verticalGuide:s,horizontalGuide:u};c.options=this._ctx.options,this.setSelectedCoordinates(this.pathsToCoordinates(r,c.selectedCoordPaths)),this.setSelected(r),rn.disable(this),this.setActionableState({trash:!0});var l=function(){var t=Kr(ar(e.map,e._ctx.api,n),2),r=t[0],o=t[1];c.vertices=o,c.snapList=r};c.updateSnapList=l;var p=function(t){c.options=t};return c.optionsChangedCallBAck=p,this.map.on("draw.snap.update_snapList",l),this.map.on("draw.snap.options_changed",p),c},an.dragVertex=function(t,e,r){var n=lr(t,e),o=n.lng,i=n.lat;t.feature.updateCoordinate(t.selectedCoordPaths[0],o,i)},an.onStop=function(t){this.deleteFeature(or.VERTICAL_GUIDE,{silent:!0}),this.deleteFeature(or.HORIZONTAL_GUIDE,{silent:!0}),this.map.off("draw.snap.update_snapList",t.updateSnapList),this.map.off("draw.snap.options_changed",t.optionsChangedCallBAck),nn.onStop.call(this,t)};const sn=an;function un(t){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},un(t)}function cn(t){return function(t){if(Array.isArray(t))return ln(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ln(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ln(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function pn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function dn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?pn(Object(r),!0).forEach((function(e){hn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function hn(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=un(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==un(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var fn=de.lib.theme.map((function(t){return"gl-draw-line-inactive"===t.id?dn(dn({},t),{},{filter:[].concat(cn(t.filter),[["!=","user_isSnapGuide","true"]])}):t}));const gn=[].concat(cn(fn),[{id:"guide",type:"line",filter:["all",["==","$type","LineString"],["==","user_isSnapGuide","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#c00c00","line-width":1,"line-dasharray":[5,5]}}])})(),n})()));
//# sourceMappingURL=mapbox-gl-draw-snap-mode.js.map